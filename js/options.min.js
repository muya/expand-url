function getVersion(){var e=chrome.app.getDetails();return e.version}function resetUserSettings(){var e={open_expanded_url_action:Config.default_expand_url_action};return chrome.storage.sync.set(e),void 0!==chrome.runtime.lastError?(console.error("an error occurred while resetting settings in chrome storage: "+chrome.runtime.lastError),!1):!0}function saveUserSettings(e){return chrome.storage.sync.set(e),void 0!==chrome.runtime.lastError?(console.error("an error occurred while saving to chrome storage: "+chrome.runtime.lastError),!1):!0}function restoreUserSettings(e){chrome.storage.sync.get("open_expanded_url_action",function(t){return void 0!==chrome.runtime.lastError?(console.error("an error occurred while fetching chrome storage data: "+chrome.runtime.lastError),void displayUserAlert("error",chrome.i18n.getMessage("restoreUserSettingsFailed"))):(void 0===t.open_expanded_url_action&&(t.open_expanded_url_action=Config.default_expand_url_action),updateSettingsUI(t)?(console.log("settings reset OK"),void(e===!0&&displayUserAlert("success",chrome.i18n.getMessage("restoreUserSettingsSuccess")))):void displayUserAlert("warning",chrome.i18n.getMessage("restoreUserSettingsSuccessNoUpdate")))})}function updateSettingsUI(e){return $.each(e,function(e,t){if(console.log(e+":"+t),"open_expanded_url_action"===e){var r=$('input[name="openExpandedUrlOptions"]');r.filter("[value="+t+"]").prop("checked",!0)}}),!0}document.addEventListener("DOMContentLoaded",function(){$(".menu a").click(function(e){e.preventDefault();var t="selected";$(".mainview > *").removeClass(t),$(".menu li").removeClass(t),setTimeout(function(){$(".mainview > *:not(.selected)").css("display","none")},100),$(e.currentTarget).parent().addClass(t);var r=$($(e.currentTarget).attr("href"));r.css("display","block"),setTimeout(function(){r.addClass(t)},0),setTimeout(function(){$("body")[0].scrollTop=0},200)}),$("#resetSettings").click(function(e){e.preventDefault();var t=$(".overlay").clone();$(t).removeAttr("style"),$(t).find("button, .close-button").click(function(){$(t).addClass("transparent"),setTimeout(function(){$(t).remove()},1e3)}),$(t).click(function(){$(t).find(".page").addClass("pulse"),$(t).find(".page").on("webkitAnimationEnd",function(){$(this).removeClass("pulse")})}),$(t).find(".page").click(function(e){e.stopPropagation()}),$(t).find("#confirmResetAccept").click(function(){resetUserSettings()?(console.log("reset successful"),restoreUserSettings(!1),$("#saveSettings").attr("disabled",!0),$("#discardSettings").attr("disabled",!0),displayUserAlert("success",chrome.i18n.getMessage("resetToDefaultSuccess"))):displayUserAlert("error",chrome.i18n.getMessage("resetToDefaultFailed"))}),$("body").append(t)}),$(".mainview > *:not(.selected)").css("display","none"),$('input[name="openExpandedUrlOptions"]').change(function(){$("#saveSettings").removeAttr("disabled"),$("#discardSettings").removeAttr("disabled")}),$("#discardSettings").click(function(){restoreUserSettings(!0),$("#saveSettings").attr("disabled",!0),$("#discardSettings").attr("disabled",!0)}),$("#saveSettings").click(function(){var e={},t=$('input[type="radio"]:checked').val();return e.open_expanded_url_action=t,saveUserSettings(e)?($("#saveSettings").attr("disabled",!0),$("#discardSettings").attr("disabled",!0),void displayUserAlert("success",chrome.i18n.getMessage("saveUserSettingsSuccess"))):void displayUserAlert("error",chrome.i18n.getMessage("saveUserSettingsFailed"))}),$(function(){$("[data-i18n]").each(function(){var e=$(this),t=e.data("i18n");e.html("versionText"===t?chrome.i18n.getMessage(t,[chrome.i18n.getMessage("extName"),getVersion()]):chrome.i18n.getMessage(t))})}),restoreUserSettings(!1)});